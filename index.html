<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>BART dashboard by dsm</title>
  <style>
  body {
    font-family: futura;
    
    margin: 0 250px;
    text-align:center;
    background-image: url(BART_cc_map);
    background-color: rgba(64,224,208,.4);
    background-repeat: no-repeat;
  }

  .main {
    background:white;
    border-radius:15px;
    display: grid;
    grid: minmax(100px,1fr)/repeat(2,minmax(100px,1fr));
    align-items: end;
    padding:10px 50px;
    text-align:left;
   
  }

  footer {
    margin: 20px 0;
    padding: 20px;
    background-color:lightgreen;
    border-radius:15px;
    font-size: .8em;
  }

  ul {
    list-style:none;
    margin:0;
    padding:0;
  }

  h1 {
    font-size:2em;
  }

  h2 {
    height: auto;
  }

  .destinations {
    color: #1CE;
    font-size: 24px;
  }

  .times {
    display:flex;
    font-size: 36px;
    color:darkslategray;
    font-weight:bold;
  } 

  #map {
    max-width:100%;
    height:auto;
  }

  </style>

</head>

<body>
  <header>
    <h1>BART Dashboard by dsm</h1>
  </header>

  <div class="main">
    <div id="time-estimate"><h2>Next train departing 24th Street: </h2></div>
    <div>
      <img src="BART_cc_map.png" alt="Map of BART stations" id="map">
    </div>
  </div>

  <footer>
    For more by dsm say hi on twitter <a href="https://www.twitter.com/dsmadrigal/" target="_blank"> @dsmadrigal</a>.
  </footer>

  </div>

  <script>

    const APIkey = "QKBL-P2TX-9BBT-DWE9";

    const timeEst = document.querySelector("#time-estimate");

    fetch('https://api.bart.gov/api/etd.aspx?cmd=etd&orig=24th&key=MW9S-E7SL-26DU-VV8V&json=y')
      .then(function(response) {
        return response.json();
      })
      .then(function(myJson) {
        const etds = myJson.root.station[0].etd;
        
        let times = '<h2>Next train departing 24th Street: </h2><ul class="destinations">';

        // adding the destinations and times to the page
        etds.forEach(element => {
          times += `<li>${element.destination}</li><ul class="times">`;
          element.estimate.forEach(x => {
            times += `<li>${x.minutes}, &nbsp</li>`;
          });
          times +='</ul>';
        });

        times += "</ul>";


        timeEst.innerHTML = times;
      
      });
  
  
  
  </script> 

</body>
</html>
